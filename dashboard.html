<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Drive - Pro Clone</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    
    <style>
        /* --- THEME VARIABLES (Light Mode Default) --- */
        :root {
            --primary-color: #1a73e8;
            --bg-color: #f7f9fc;
            --surface-color: #ffffff;
            --panel-color: #ffffff;
            --text-main: #202124;
            --text-secondary: #5f6368;
            --border-color: #dadce0;
            --hover-color: #f1f3f4;
            --sidebar-width: 256px;
            --header-height: 64px;
            --input-bg: #ffffff;
            --shadow: rgba(0,0,0,0.2);
        }

        /* --- DARK MODE (System Auto-Detect) --- */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #181818;       /* Main Background */
                --surface-color: #1f1f1f;  /* Header/Sidebar */
                --panel-color: #2d2e30;    /* Modals/Dropdowns */
                --text-main: #e8eaed;
                --text-secondary: #9aa0a6;
                --border-color: #444746;
                --hover-color: #303134;
                --input-bg: #303134;
                --shadow: rgba(0,0,0,0.5);
            }
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Roboto', sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-main); overflow: hidden; height: 100vh; display: flex; flex-direction: column; transition: background 0.3s, color 0.3s; }

        /* --- UTILS --- */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 2000; display: none;
            justify-content: center; align-items: center;
        }
        
        /* MODAL */
        .modal {
            background: var(--panel-color); width: 400px; padding: 24px; border-radius: 8px;
            box-shadow: 0 4px 10px var(--shadow); display: flex; flex-direction: column; gap: 15px;
            border: 1px solid var(--border-color);
        }
        .modal h3 { font-weight: 500; margin-bottom: 5px; }
        .modal label { font-size: 12px; color: var(--text-secondary); margin-bottom: -5px; margin-top: 5px; }
        .modal input { 
            padding: 10px; border: 1px solid var(--border-color); border-radius: 4px; 
            width: 100%; background: var(--input-bg); color: var(--text-main); outline: none;
        }
        .modal input:focus { border-color: var(--primary-color); }
        .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }
        
        .btn { padding: 8px 16px; border-radius: 4px; border: none; cursor: pointer; font-weight: 500; }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-secondary { background: transparent; color: var(--text-main); border: 1px solid var(--border-color); }
        .btn-secondary:hover { background: var(--hover-color); }

        /* --- HEADER --- */
        header { height: var(--header-height); display: flex; align-items: center; padding: 8px 20px; justify-content: space-between; border-bottom: 1px solid var(--border-color); background: var(--surface-color); }
        .logo-area { display: flex; align-items: center; width: var(--sidebar-width); }
        .logo-area img { height: 40px; margin-right: 8px; }
        .logo-area span { font-size: 22px; color: var(--text-secondary); }
        
        .search-bar { 
            flex: 1; max-width: 720px; background: var(--hover-color); height: 48px; 
            border-radius: 8px; display: flex; align-items: center; padding: 0 12px; margin: 0 20px; 
        }
        .search-bar input { border: none; background: transparent; flex: 1; height: 100%; margin-left: 10px; outline: none; font-size: 16px; color: var(--text-main); }
        .icon-btn { color: var(--text-secondary); cursor: pointer; padding: 8px; border-radius: 50%; }
        .icon-btn:hover { background: var(--hover-color); }

        .header-actions { display: flex; gap: 12px; align-items: center; }
        .avatar { width: 32px; height: 32px; background-color: purple; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; overflow: hidden; font-size: 14px; }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }

        /* --- SIDEBAR --- */
        .main-container { display: flex; flex: 1; overflow: hidden; }
        .sidebar { width: var(--sidebar-width); padding: 12px 0; display: flex; flex-direction: column; background: var(--surface-color); }
        
        .new-btn {
            display: flex; align-items: center; width: fit-content; height: 48px; background: var(--panel-color);
            border-radius: 24px; padding: 0 24px 0 16px; box-shadow: 0 1px 3px var(--shadow);
            margin: 0 0 16px 16px; cursor: pointer; transition: 0.2s; position: relative; color: var(--text-main);
        }
        .new-btn:hover { box-shadow: 0 4px 8px var(--shadow); background-color: var(--hover-color); }
        
        .new-dropdown {
            position: absolute; top: 50px; left: 0; background: var(--panel-color); width: 200px;
            box-shadow: 0 2px 10px var(--shadow); border-radius: 4px; display: none; z-index: 100; padding: 5px 0; border: 1px solid var(--border-color);
        }
        .new-dropdown div { padding: 10px 20px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 14px; color: var(--text-main); }
        .new-dropdown div:hover { background: var(--hover-color); }

        .nav-item { display: flex; align-items: center; height: 40px; padding-left: 24px; border-radius: 0 20px 20px 0; cursor: pointer; color: var(--text-main); font-size: 14px; margin-right: 12px; }
        .nav-item.active { background-color: #e8f0fe; color: #1967d2; font-weight: 500; }
        /* Dark mode specific active state */
        @media (prefers-color-scheme: dark) {
            .nav-item.active { background-color: #394457; color: #8ab4f8; }
        }
        .nav-item:hover:not(.active) { background-color: var(--hover-color); }

        /* --- CONTENT --- */
        .content { 
            flex: 1; background-color: var(--bg-color); border-radius: 16px 16px 0 0; padding: 16px; 
            overflow-y: auto; display: flex; flex-direction: column;
            border-top: 1px solid var(--border-color); border-left: 1px solid var(--border-color); 
        }
        
        .breadcrumb-bar { font-size: 18px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); margin-bottom: 10px; display: flex; gap: 5px; align-items: center; color: var(--text-secondary); }
        .crumb { cursor: pointer; padding: 4px 8px; border-radius: 4px; }
        .crumb:hover { background: var(--hover-color); color: var(--text-main); }
        .crumb:last-child { color: var(--text-main); font-weight: 500; cursor: default; }

        .file-list-header { display: grid; grid-template-columns: 2fr 1fr 1fr 50px; padding: 8px 16px; border-bottom: 1px solid var(--border-color); color: var(--text-secondary); font-size: 13px; font-weight: 500; }
        .file-row { display: grid; grid-template-columns: 2fr 1fr 1fr 50px; padding: 12px 16px; border-bottom: 1px solid var(--border-color); align-items: center; font-size: 13px; cursor: pointer; user-select: none; color: var(--text-main); }
        .file-row:hover { background-color: var(--hover-color); }
        .file-name-cell { display: flex; align-items: center; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        
        /* CONTEXT MENU */
        .context-menu {
            position: absolute; right: 50px; top: 30px; background: var(--panel-color); 
            border: 1px solid var(--border-color); box-shadow: 0 2px 10px var(--shadow); 
            border-radius: 4px; z-index: 100; display: none; width: 180px;
        }
        .context-menu div { padding: 10px 15px; cursor: pointer; display: flex; align-items: center; gap: 10px; color: var(--text-main); }
        .context-menu div:hover { background: var(--hover-color); }
        
        /* PROFILE POPUP */
        .profile-popup {
            position: absolute; top: 60px; right: 20px; width: 320px; background: var(--panel-color);
            box-shadow: 0 4px 12px var(--shadow); border-radius: 10px; z-index: 150; padding: 20px;
            display: none; text-align: center; border: 1px solid var(--border-color);
        }
        .profile-popup .large-avatar { 
            width: 80px; height: 80px; background: purple; border-radius: 50%; margin: 0 auto 10px; 
            display: flex; align-items: center; justify-content: center; font-size: 32px; color: white; 
            position: relative; overflow: hidden; cursor: pointer;
        }
        .profile-popup .large-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .cam-overlay {
            position: absolute; bottom:0; left:0; width:100%; background:rgba(0,0,0,0.5); 
            color:white; font-size:10px; padding:4px 0; display:none;
        }
        .large-avatar:hover .cam-overlay { display:block; }

        .account-item { display: flex; align-items: center; padding: 10px; border-top: 1px solid var(--border-color); cursor: pointer; text-align: left; color: var(--text-main); }
        .account-item:hover { background: var(--hover-color); }
        
    </style>
</head>
<body>

    <div id="loginOverlay" class="overlay" style="display: flex; background: var(--surface-color);">
        <div class="modal" style="text-align: center; align-items: center;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/d/da/Google_Drive_logo_%282020%29.svg" width="60">
            <h2 style="color: var(--text-main);">Sign in</h2>
            <p style="color: var(--text-secondary); margin-bottom: 10px;">to continue to Drive</p>
            
            <input type="text" id="loginId" placeholder="Email or Phone" value="user@example.com">
            <input type="password" id="loginPass" placeholder="Enter your password">
            <p id="loginError" style="color: red; font-size: 12px; display: none;">Please enter both ID and Password</p>
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="attemptLogin()">Next</button>
        </div>
    </div>

    <div id="app" style="display:none; height: 100%; flex-direction: column;">
        <header>
            <div class="logo-area">
                <img src="https://upload.wikimedia.org/wikipedia/commons/d/da/Google_Drive_logo_%282020%29.svg" alt="Drive">
                <span>Drive</span>
            </div>
            <div class="search-bar">
                <span class="material-icons-outlined" style="color: var(--text-secondary);">search</span>
                <input type="text" placeholder="Search in Drive" id="searchInput" onkeyup="renderFiles()">
            </div>
            <div class="header-actions">
                <span class="material-icons-outlined icon-btn">help_outline</span>
                <span class="material-icons-outlined icon-btn">settings</span>
                <div class="avatar" onclick="toggleProfile()">
                    <span id="headerAvatarText">U</span>
                    <img id="headerAvatarImg" style="display:none;">
                </div>
            </div>

            <div class="profile-popup" id="profilePopup">
                <div class="large-avatar" onclick="openManageAccount()">
                    <span id="popupAvatarText">U</span>
                    <img id="popupAvatarImg" style="display:none;">
                    <div class="cam-overlay">EDIT</div>
                </div>
                <h3 id="displayName" style="color: var(--text-main);">User Name</h3>
                <p id="displayEmail" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 15px;">user@example.com</p>
                
                <button class="btn btn-secondary" style="width:100%; margin-bottom: 10px;" onclick="openManageAccount()">Manage Account</button>
                
                <div class="account-item" onclick="alert('Switching account (Demo)...')">
                    <span class="material-icons-outlined" style="margin-right: 10px; color: var(--text-secondary);">person_add</span>
                    Add another account
                </div>
                <div class="account-item" onclick="logout()">
                    <span class="material-icons-outlined" style="margin-right: 10px; color: var(--text-secondary);">logout</span>
                    Sign out
                </div>
            </div>
        </header>

        <div class="main-container">
            <aside class="sidebar">
                <div class="new-btn" onclick="toggleNewMenu()">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/9/9e/Plus_symbol.svg" width="24">
                    <span>New</span>
                    <div class="new-dropdown" id="newMenu">
                        <div onclick="createFolderPrompt()"><span class="material-icons-outlined">create_new_folder</span> New Folder</div>
                        <div onclick="document.getElementById('fileUpload').click()"><span class="material-icons-outlined">upload_file</span> File Upload</div>
                    </div>
                </div>
                <input type="file" id="fileUpload" hidden onchange="handleFileUpload(event)">
                
                <div class="nav-item active"><span class="material-icons-outlined">hard_drive</span> My Drive</div>
                <div class="nav-item"><span class="material-icons-outlined">schedule</span> Recent</div>
                <div class="nav-item"><span class="material-icons-outlined">delete</span> Trash</div>
            </aside>

            <main class="content">
                <div class="breadcrumb-bar" id="breadcrumbs">My Drive</div>
                <div class="file-list-header">
                    <div>Name</div>
                    <div>Owner</div>
                    <div>Last Modified</div>
                    <div></div>
                </div>
                <div id="fileList">
                    </div>
            </main>
        </div>
    </div>

    <div id="accountModal" class="overlay">
        <div class="modal">
            <h3>Manage Account</h3>
            <div style="display: flex; gap: 15px; align-items: center;">
                <div class="large-avatar" style="width: 60px; height: 60px; cursor: pointer;" onclick="document.getElementById('avatarInput').click()">
                    <span id="manageAvatarText">U</span>
                    <img id="manageAvatarImg" style="display:none;">
                    <div class="cam-overlay">UPLOAD</div>
                </div>
                <div style="flex:1">
                    <label>Profile Picture</label>
                    <p style="font-size: 12px; color: var(--text-secondary);">Click image to change</p>
                </div>
            </div>
            <input type="file" id="avatarInput" hidden onchange="previewAvatar(event)">
            
            <label>Display Name</label>
            <input type="text" id="editName" placeholder="Your Name">
            
            <label>Change Password</label>
            <input type="password" id="editPass" placeholder="New Password">
            <input type="password" id="editPassConfirm" placeholder="Confirm New Password">

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeOverlay('accountModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveAccountChanges()">Save Changes</button>
            </div>
        </div>
    </div>

    <script>
        // --- USER STATE ---
        let user = {
            name: "Demo User",
            email: "user@example.com",
            password: "password123",
            avatar: null
        };
        
        let pendingAvatar = null; // Temp store for avatar preview

        // --- FILE SYSTEM STATE ---
        let files = [
            { id: 1, name: "Work_Documents", type: "folder", date: "Jan 10" },
            { id: 2, name: "Project_Specs.pdf", type: "file", date: "Feb 12" },
            { id: 3, name: "Budget_2026.xlsx", type: "file", date: "Today" }
        ];

        // --- LOGIN LOGIC ---
        function attemptLogin() {
            const id = document.getElementById('loginId').value;
            const pass = document.getElementById('loginPass').value;
            const err = document.getElementById('loginError');

            if(id && pass) {
                // Update user email to whatever they typed for realism
                user.email = id;
                user.name = id.split('@')[0];
                refreshUI();
                
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('app').style.display = 'flex';
                err.style.display = 'none';
            } else {
                err.style.display = 'block';
            }
        }

        function logout() {
            document.getElementById('app').style.display = 'none';
            document.getElementById('loginOverlay').style.display = 'flex';
            document.getElementById('loginPass').value = ''; // Clear pass
        }

        // --- MANAGE ACCOUNT LOGIC ---
        function openManageAccount() {
            document.getElementById('profilePopup').style.display = 'none'; // Close dropdown
            
            // Pre-fill fields
            document.getElementById('editName').value = user.name;
            document.getElementById('editPass').value = "";
            document.getElementById('editPassConfirm').value = "";
            
            // Set Avatar Preview in Modal
            updateAvatarDisplay('manageAvatarText', 'manageAvatarImg', user.avatar, user.name);

            document.getElementById('accountModal').style.display = 'flex';
        }

        function previewAvatar(e) {
            const file = e.target.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = function(res) {
                    pendingAvatar = res.target.result;
                    document.getElementById('manageAvatarImg').src = pendingAvatar;
                    document.getElementById('manageAvatarImg').style.display = 'block';
                    document.getElementById('manageAvatarText').style.display = 'none';
                }
                reader.readAsDataURL(file);
            }
        }

        function saveAccountChanges() {
            const newName = document.getElementById('editName').value;
            const newPass = document.getElementById('editPass').value;
            const confirmPass = document.getElementById('editPassConfirm').value;

            // Update Name
            if(newName) user.name = newName;

            // Update Password
            if(newPass) {
                if(newPass !== confirmPass) {
                    alert("Passwords do not match!");
                    return;
                }
                user.password = newPass;
                alert("Password changed successfully.");
            }

            // Update Avatar
            if(pendingAvatar) {
                user.avatar = pendingAvatar;
                pendingAvatar = null;
            }

            refreshUI();
            closeOverlay('accountModal');
        }

        function refreshUI() {
            // Header Info
            document.getElementById('displayName').innerText = user.name;
            document.getElementById('displayEmail').innerText = user.email;

            // Avatars (Header, Popup, ManageModal)
            updateAvatarDisplay('headerAvatarText', 'headerAvatarImg', user.avatar, user.name);
            updateAvatarDisplay('popupAvatarText', 'popupAvatarImg', user.avatar, user.name);
        }

        function updateAvatarDisplay(textId, imgId, avatarSrc, name) {
            if(avatarSrc) {
                document.getElementById(imgId).src = avatarSrc;
                document.getElementById(imgId).style.display = 'block';
                document.getElementById(textId).style.display = 'none';
            } else {
                document.getElementById(textId).innerText = name ? name[0].toUpperCase() : 'U';
                document.getElementById(textId).style.display = 'block';
                document.getElementById(imgId).style.display = 'none';
            }
        }

        // --- DASHBOARD CORE FUNCTIONS ---
        function renderFiles() {
            const list = document.getElementById('fileList');
            list.innerHTML = '';
            files.forEach(f => {
                const row = document.createElement('div');
                row.className = 'file-row';
                let icon = f.type === 'folder' ? 'folder' : 'description';
                let color = f.type === 'folder' ? 'var(--text-secondary)' : '#1a73e8';
                
                row.innerHTML = `
                    <div class="file-name-cell">
                        <span class="material-icons-outlined" style="margin-right:12px; color:${color}">${icon}</span>
                        ${f.name}
                    </div>
                    <div>${user.name}</div>
                    <div>${f.date}</div>
                    <div><span class="material-icons-outlined" style="color:var(--text-secondary)">more_vert</span></div>
                `;
                list.appendChild(row);
            });
        }

        function handleFileUpload(e) {
            const file = e.target.files[0];
            if(file) {
                files.push({ id: Date.now(), name: file.name, type: 'file', date: 'Just now' });
                renderFiles();
            }
        }

        function createFolderPrompt() {
            const name = prompt("Folder Name:");
            if(name) {
                files.push({ id: Date.now(), name: name, type: 'folder', date: 'Just now' });
                renderFiles();
            }
        }

        // Utils
        function toggleProfile() {
            const p = document.getElementById('profilePopup');
            p.style.display = p.style.display === 'block' ? 'none' : 'block';
        }
        function toggleNewMenu() {
            const m = document.getElementById('newMenu');
            m.style.display = m.style.display === 'block' ? 'none' : 'block';
        }
        function closeOverlay(id) { document.getElementById(id).style.display = 'none'; }

        // Init
        renderFiles();
        
        // Close menus when clicking outside
        window.onclick = function(event) {
            if (!event.target.closest('.new-btn')) document.getElementById('newMenu').style.display = 'none';
        }

    </script>
</body>
</html>
